(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7d6a3706"],{"4fe8":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"topic-main"},[r("div",{staticClass:"topic-header"},[r("div",{staticClass:"topic-header"},[r("el-drawer",{attrs:{"with-header":!1,visible:e.drawer,direction:"rtl","before-close":e.handleClose,size:"20%"},on:{"update:visible":function(t){e.drawer=t}}},[r("div",{staticClass:"drawer-main"},[r("div",{staticClass:"drawer-header clearfix"},[r("div",{staticClass:"drawer-left"},[r("i",{staticClass:"el-icon-warning-outline"}),r("div",{staticClass:"drawer-title"},[e._v("搜索回答")])]),r("div",{staticClass:"drawer-right"},[r("i",{staticClass:"el-icon-close",on:{click:function(t){e.drawer=!1}}})])]),r("div",{staticClass:"drawer-input"},[r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{span:7}},[r("div",{staticClass:"drawer-label"},[e._v("标题:")])]),r("el-col",{attrs:{span:17}},[r("el-input",{model:{value:e.reqData.title,callback:function(t){e.$set(e.reqData,"title",t)},expression:"reqData.title"}})],1)],1),r("el-row",{staticStyle:{padding:"20px 0 20px 0"},attrs:{gutter:20}},[r("el-col",{attrs:{span:9}},[r("div",{staticClass:"drawer-label"},[e._v("作者UID:")])]),r("el-col",{attrs:{span:15}},[r("el-input",{model:{value:e.reqData.userid,callback:function(t){e.$set(e.reqData,"userid",t)},expression:"reqData.userid"}})],1)],1),r("el-row",[r("el-col",{attrs:{span:24}},[r("div",{staticClass:"btns"},[r("el-button",{attrs:{size:"small",type:"primary",plain:""},nativeOn:{click:function(t){return t.stopPropagation(),e.restReqdata(t)}}},[e._v("重置")]),r("el-button",{attrs:{size:"small",type:"primary",plain:""},nativeOn:{click:function(t){return t.stopPropagation(),e.handleSearch(t)}}},[e._v("搜索")])],1)])],1)],1)])]),r("el-row",[r("el-col",{attrs:{span:2}},[r("el-button",{attrs:{size:"small",icon:"el-icon-refresh"},on:{click:e.refeshForm}})],1),r("el-col",{attrs:{span:2,offset:20}},[r("el-button",{attrs:{type:"success",icon:"el-icon-search",size:"small"},on:{click:e.openDrawer}})],1)],1)],1)]),r("div",{staticClass:"topic-table"},[r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.tableData,size:"small"}},[r("el-table-column",{attrs:{label:"ID",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(t.row.id))])]}}])}),r("el-table-column",{attrs:{label:"发布人ID",width:"250"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(t.row.userid))])]}}])}),r("el-table-column",{attrs:{label:"标题",width:"300"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(t.row.title))])]}}])}),r("el-table-column",{attrs:{label:"状态",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(e._f("switchType")(t.row.type)))])]}}])}),r("el-table-column",{attrs:{label:"热度",width:"70"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(t.row.heat))])]}}])}),r("el-table-column",{attrs:{label:"赞同数",width:"70"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(t.row.agree))])]}}])}),r("el-table-column",{attrs:{label:"评论数",width:"70"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(t.row.comment))])]}}])}),r("el-table-column",{attrs:{label:"关注数",width:"70"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(t.row.follow))])]}}])}),r("el-table-column",{attrs:{label:"浏览量",width:"70"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(t.row.brower))])]}}])}),r("el-table-column",{attrs:{label:"创建时间",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(e.parseTime(t.row.createtime)))])]}}])}),r("el-table-column",{attrs:{label:"修改时间",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(e.parseTime(t.row.updatetime)))])]}}])}),r("el-table-column",{attrs:{label:"操作",fixed:"right",width:"260"},scopedSlots:e._u([{key:"default",fn:function(t){return r("div",{staticClass:"btns"},[r("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-view"},on:{click:function(r){return e.handleDetail(t.$index,t.row)}}}),r("el-button",{attrs:{size:"small",icon:"el-icon-edit"},on:{click:function(r){return e.handleEdit(t.$index,t.row)}}}),r("el-button",{attrs:{disabled:1!=t.row.type,size:"small",type:"primary",icon:"el-icon-check"},on:{click:function(r){return e.handlePass(t.$index,t.row)}}}),r("el-button",{attrs:{size:"small",type:"danger",icon:"el-icon-delete"},on:{click:function(r){return e.handleDelete(t.$index,t.row)}}})],1)}}])})],1),r("el-dialog",{attrs:{title:1==e.disabled?"话题详情":"编辑话题","show-close":"",top:"20px","close-on-press-escape":"",visible:e.dialogVisible,width:"70%",center:""},on:{close:e.closeDialog,"update:visible":function(t){e.dialogVisible=t}}},[r("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{disabled:e.disabled,model:e.ruleForm,rules:e.rules,"label-width":"100px"}},[r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"话题标题",prop:"title"}},[r("el-input",{model:{value:e.ruleForm.title,callback:function(t){e.$set(e.ruleForm,"title",t)},expression:"ruleForm.title"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"话题作者",prop:"userid"}},[r("el-input",{model:{value:e.ruleForm.userid,callback:function(t){e.$set(e.ruleForm,"userid",t)},expression:"ruleForm.userid"}})],1)],1)],1),r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"关注数",prop:"follow"}},[r("el-input",{model:{value:e.ruleForm.follow,callback:function(t){e.$set(e.ruleForm,"follow",t)},expression:"ruleForm.follow"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"浏览量",prop:"brower"}},[r("el-input",{model:{value:e.ruleForm.brower,callback:function(t){e.$set(e.ruleForm,"brower",t)},expression:"ruleForm.brower"}})],1)],1)],1),r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"评论数",prop:"comment"}},[r("el-input",{model:{value:e.ruleForm.comment,callback:function(t){e.$set(e.ruleForm,"comment",t)},expression:"ruleForm.comment"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"赞同数",prop:"agree"}},[r("el-input",{model:{value:e.ruleForm.agree,callback:function(t){e.$set(e.ruleForm,"agree",t)},expression:"ruleForm.agree"}})],1)],1)],1),r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"话题热度",prop:"heat"}},[r("el-input",{model:{value:e.ruleForm.heat,callback:function(t){e.$set(e.ruleForm,"heat",t)},expression:"ruleForm.heat"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"话题封面",prop:"topiccover"}},[r("el-input",{model:{value:e.ruleForm.topiccover,callback:function(t){e.$set(e.ruleForm,"topiccover",t)},expression:"ruleForm.topiccover"}})],1)],1)],1),r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"审核话题",prop:"type"}},[r("el-select",{attrs:{placeholder:"请选择"},model:{value:e.ruleForm.type,callback:function(t){e.$set(e.ruleForm,"type",t)},expression:"ruleForm.type"}},e._l(e.typeList,(function(e){return r("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})})),1)],1)],1)],1),r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{span:24}},[r("el-form-item",{attrs:{label:"话题摘要",prop:"abstract"}},[r("el-input",{attrs:{type:"textarea"},model:{value:e.ruleForm.abstract,callback:function(t){e.$set(e.ruleForm,"abstract",t)},expression:"ruleForm.abstract"}})],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:24}},[r("el-form-item",{attrs:{label:"话题详情",prop:"topic"}},[r("vue-editor",{attrs:{id:"editor",useCustomImageHandler:"",disabled:e.disabled},on:{"image-added":e.handleImageAdded},model:{value:e.ruleForm.topic,callback:function(t){e.$set(e.ruleForm,"topic",t)},expression:"ruleForm.topic"}})],1)],1)],1),r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleUpdate("ruleForm")}}},[e._v("保存")]),r("el-button",{on:{click:function(t){return e.resetForm("ruleForm")}}},[e._v("重置")])],1)],1)],1),r("el-pagination",{attrs:{"current-page":e.reqData.pageNo,"page-sizes":[10,20,30,40],"page-size":100,layout:"sizes, prev, pager, next",total:e.reqData.pageCount},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange,"update:currentPage":function(t){return e.$set(e.reqData,"pageNo",t)},"update:current-page":function(t){return e.$set(e.reqData,"pageNo",t)}}})],1)])},l=[],s=(r("d3b7"),r("e25e"),r("96cf"),r("ed08")),o=r("7457"),n=r("b775");function i(e){return Object(n["a"])({url:"/topiclist",data:e,method:"POST"})}function c(e,t){return Object(n["a"])({url:"/topic/".concat(t),data:e,method:"post"})}function u(e,t){return Object(n["a"])({url:"/delete/topic/".concat(t),data:e,method:"post"})}function d(e,t){return Object(n["a"])({url:"/update/topic/".concat(t),data:e,method:"post"})}var p=void 0,m=function(){return r.e("chunk-372f0d5a").then(r.bind(null,"a060"))},f={name:"home",data:function(){return{drawer:!1,topicid:"",disabled:!1,dialogVisible:!1,loading:!1,ruleForm:{id:"",title:"",abstract:"",userid:"",comment:"",follow:"",agree:"",heat:"",brower:"",topic:"",topiccover:""},typeList:[{name:"未审核",value:1},{name:"审核通过",value:2},{name:"审核未通过",value:3}],rules:{title:[{required:!0,message:"请输入话题标题",trigger:"blur"}],abstract:[{required:!0,message:"请输入话题简介",trigger:"blur"}],topic:[{required:!0,message:"请输入话题详情",trigger:"blur"}],topiccover:[{required:!0,message:"请上传话题封面",trigger:"blur"}],userid:[{required:!0,message:"请输入用户",trigger:"blur"}],comment:[{required:!0,message:"请输入评论数",trigger:"blur"}],follow:[{required:!0,message:"请输入关注数",trigger:"blur"}],agree:[{required:!0,message:"请输入赞同数",trigger:"blur"}],heat:[{required:!0,message:"请输入热度",trigger:"blur"}],brower:[{required:!0,message:"请输入公告详情",trigger:"blur"}],type:[{required:!0,message:"选择话题状态",trigger:"blur"}]},reqData:{title:"",pageNo:1,pageSize:10,pageCount:1,userid:""},tableData:[]}},filters:{switchType:function(e){switch(e){case 1:return"未审核";case 2:return"审核通过";default:return"未审核通过"}}},computed:{total:{get:function(){return p.reqData.total},set:function(e){p.reqData.total=e}}},methods:{handlePass:function(e,t){var r;return regeneratorRuntime.async((function(e){while(1)switch(e.prev=e.next){case 0:return r=this,t.type=2,e.next=4,regeneratorRuntime.awrap(d(t,t.id).then((function(e){e.data.success?r.$message({message:"审核通过",type:"success"}):r.$message({message:e.data.msg,type:"success"})})));case 4:case"end":return e.stop()}}),null,this)},restReqdata:function(){this.reqData.title="",this.reqData.userid=""},openDrawer:function(){this.drawer=!0},handleClose:function(e){e()},handleSearch:function(){this.getTopics(),this.drawer=!0},refeshForm:function(){this.restReqdata(),this.getTopics()},initWs:function(){this.socket=new WebSocket("ws://localhost:8080/admin/api/ws"),this.socket.addEventListener("open",(function(e){console.log("socket is open")})),this.socket.addEventListener("message",(function(e){console.log("Message from server",e.data)}))},parseTime:s["a"],submitForm:function(e){this.$refs[e].validate((function(e){if(!e)return console.log("error submit!!"),!1}))},handleUpdate:function(e){var t=this,r=this;this.$refs[e].validate((function(e){if(!e)return console.log("error submit!!"),!1;r.updateTopic(t.topicid)}))},resetForm:function(e){this.$refs[e].resetFields()},closeDialog:function(){console.log("调用打印"),this.clearReqdata("ruleForm")},findProject:function(){console.log("打印reqdata"),console.log(this.reqData),this.getTopics()},clearReqdata:function(e){this.reqData.title="",this.reqData.userid="",this.disabled=!1,this.$refs[e].clearValidate()},restProject:function(){this.clearReqdata("ruleForm")},handleSizeChange:function(e){console.log("每页 ".concat(e," 条")),this.reqData.pageSize=e},handleCurrentChange:function(e){console.log("当前页: ".concat(e))},handleChange:function(e){console.log("打印子组件传递的"),console.log(e)},topicDetail:function(e){var t;return regeneratorRuntime.async((function(r){while(1)switch(r.prev=r.next){case 0:return t=this,r.next=3,regeneratorRuntime.awrap(c({id:e},e).then((function(e){console.log(e),t.ruleForm=e.data.data,console.log(t.ruleForm)})));case 3:case"end":return r.stop()}}),null,this)},updateTopic:function(e){var t;return regeneratorRuntime.async((function(r){while(1)switch(r.prev=r.next){case 0:return t=this,r.next=3,regeneratorRuntime.awrap(d(this.ruleForm,e).then((function(e){console.log(e),e.data.success&&(t.$message({message:e.data.msg,type:"success"}),t.clearReqdata("ruleForm"),t.disabled=!1,t.getTopics(),t.dialogVisible=!1)})));case 3:case"end":return r.stop()}}),null,this)},deleteTopic:function(e){var t,r;return regeneratorRuntime.async((function(a){while(1)switch(a.prev=a.next){case 0:return t={},t.id=e,r=this,a.next=5,regeneratorRuntime.awrap(u(t,e).then((function(e){e.data.success?(r.$message({type:"success",message:e.data.msg}),r.getTopics()):r.$message({type:"error",message:e.data.msg}),console.log(e)})));case 5:case"end":return a.stop()}}),null,this)},getTopics:function(){var e;return regeneratorRuntime.async((function(t){while(1)switch(t.prev=t.next){case 0:return e=this,this.loading=!0,t.next=4,regeneratorRuntime.awrap(i(this.reqData).then((function(t){console.log(t),e.tableData=t.data,e.total=parseInt(t.pageCount),e.loading=!1})).catch((function(){e.loading=!1})));case 4:case"end":return t.stop()}}),null,this)},handleDetail:function(e,t){this.disabled=!0,this.topicDetail(t.id),this.dialogVisible=!0},handleEdit:function(e,t){this.topicid=t.id,this.disabled=!1,this.dialogVisible=!0,this.topicDetail(t.id)},handleDelete:function(e,t){var r=this;console.log(e,t);var a=this;console.log("删除"),this.ruleForm={},this.$confirm("此操作将删除该公告, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){a.deleteTopic(t.id)})).catch((function(){r.$message({type:"info",message:"已取消删除"})}))},handleImageAdded:function(e,t,r,a){var l;return regeneratorRuntime.async((function(s){while(1)switch(s.prev=s.next){case 0:return this,l=new FormData,l.append("file",e),s.next=5,regeneratorRuntime.awrap(myaxios.upload(l).then((function(e){var l=e.data;console.log(l);var s=e.data.url;t.insertEmbed(r,"image",s),a()})));case 5:case"end":return s.stop()}}),null,this)}},created:function(){console.log("打印store"),console.log(this.$store),this.getTopics()},components:{searchBtns:m,VueEditor:o["a"]},activated:function(){this.$store.state.admin.tags=[]}},g=f,h=(r("608b"),r("2877")),b=Object(h["a"])(g,a,l,!1,null,"0aa4662a",null);t["default"]=b.exports},"608b":function(e,t,r){"use strict";var a=r("7125"),l=r.n(a);l.a},7125:function(e,t,r){}}]);
//# sourceMappingURL=chunk-7d6a3706.f8007709.js.map